# Generated by Django 4.0 on 2022-04-05 00:31

from django.db import migrations, models
import django.db.models.deletion


class Migration(migrations.Migration):

    initial = True

    dependencies = [
    ]

    operations = [
        migrations.CreateModel(
            name='Blacklist',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('auto_added', models.BooleanField(default=False, editable=False, help_text='Whether this was added by system', verbose_name='Auto Added')),
                ('prefix', models.CharField(help_text='The prefix in IP/CIDR format', max_length=32, verbose_name='Prefix')),
            ],
            options={
                'verbose_name_plural': 'blacklist IPs',
            },
        ),
        migrations.CreateModel(
            name='Connection',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('enabled', models.BooleanField(default=True, help_text='Enable connection.', verbose_name='Enabled')),
                ('protocol', models.CharField(choices=[('udp', 'UDP'), ('tcp', 'TCP'), ('icmp', 'ICMP')], default='udp', help_text='The protocol for this connection.', max_length=12, verbose_name='Protocol')),
                ('bind_ip', models.CharField(help_text='Usually game server IP/Anycast IP', max_length=32, verbose_name='Bind IP')),
                ('bind_port', models.IntegerField(help_text='Usually the game server port (e.g. 27015).', verbose_name='Bind Port')),
                ('dest_ip', models.CharField(help_text='The game server machine IP.', max_length=32, verbose_name='Dest IP')),
                ('dest_port', models.IntegerField(default=0, help_text='Port to translate to (0 = bind port, default).', verbose_name='Dest Port')),
                ('filters', models.IntegerField(choices=[(0, 'None'), (1, 'SRCDS'), (2, 'Rust'), (4, 'GMOD')], default=0, help_text='Filters to apply for this connection.', verbose_name='Filters')),
                ('udp_rl_bl', models.IntegerField(default=0, help_text='UDP rate limit block time.', verbose_name='UDP RL BL')),
                ('udp_rl_pps', models.IntegerField(default=0, help_text='UDP rate limit PPS limit.', verbose_name='UDP RL PPS')),
                ('udp_rl_bps', models.IntegerField(default=0, help_text='UDP rate limit BPS limit.', verbose_name='UDP RL BPS')),
                ('tcp_rl_bl', models.IntegerField(default=0, help_text='TCP rate limit block time.', verbose_name='TCP RL BL')),
                ('tcp_rl_pps', models.IntegerField(default=0, help_text='TCP rate limit PPS limit.', verbose_name='TCP RL PPS')),
                ('tcp_rl_bps', models.IntegerField(default=0, help_text='TCP rate limit BPS limit.', verbose_name='TCP RL BPS')),
                ('icmp_rl_bl', models.IntegerField(default=0, help_text='ICMP rate limit block time.', verbose_name='ICMP RL BL')),
                ('icmp_rl_pps', models.IntegerField(default=0, help_text='ICMP rate limit PPS limit.', verbose_name='ICMP RL PPS')),
                ('icmp_rl_bps', models.IntegerField(default=0, help_text='ICMP rate limit BPS limit.', verbose_name='ICMP RL BPS')),
                ('syn_rl_bl', models.IntegerField(default=0, help_text='TCP SYN rate limit block time.', verbose_name='SYN RL BL')),
                ('syn_rl_pps', models.IntegerField(default=0, help_text='TCP SYN rate limit PPS limit.', verbose_name='SYN RL PPS')),
                ('syn_rl_bps', models.IntegerField(default=0, help_text='TCP SYN rate limit BPS limit.', verbose_name='SYN RL BPS')),
                ('a2s_info_enabled', models.BooleanField(default=False, help_text='Whether to enable A2S_INFO caching.', verbose_name='A2S_INFO Caching')),
                ('a2s_info_cache_time', models.IntegerField(default=45, help_text='A2S_INFO cache time if enabled.', verbose_name='A2S_INFO Cache Time')),
                ('a2s_info_global_cache', models.BooleanField(default=False, help_text='Whether to enable A2S_INFO global caching.', verbose_name='A2S_INFO Global Cache')),
                ('a2s_info_cache_timeout', models.IntegerField(default=180, help_text='A2S_INFO cache timeout for expired caches.', verbose_name='A2S_INFO Cache Timeout')),
                ('pps', models.BigIntegerField(editable=False, null=True)),
                ('bps', models.BigIntegerField(editable=False, null=True)),
            ],
        ),
        migrations.CreateModel(
            name='Edge',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('name', models.CharField(blank=True, help_text='Display name of edge.', max_length=32, verbose_name='name')),
                ('ip', models.CharField(help_text='The edge server IP.', max_length=32, verbose_name='IP')),
                ('status', models.BooleanField(default=False, editable=False, verbose_name='Status')),
                ('xdp_status', models.BooleanField(default=False, editable=False, verbose_name='XDP Status')),
            ],
        ),
        migrations.CreateModel(
            name='Port_Punch',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('auto_added', models.BooleanField(default=False, editable=False, help_text='Whether this was added by system', verbose_name='Auto Added')),
                ('ip', models.CharField(help_text='IP address', max_length=32, verbose_name='IP Address')),
                ('port', models.IntegerField(default=0, help_text='Port', verbose_name='Port')),
                ('cnt', models.IntegerField(default=0, editable=False, null=True)),
                ('service_ip', models.CharField(help_text='Service IP address', max_length=32, verbose_name='Service IP Address')),
                ('service_port', models.IntegerField(default=0, help_text='Service Port', verbose_name='Service Port')),
                ('dest_ip', models.CharField(help_text="The game server machine's IP address", max_length=32, verbose_name='Destination IP Address')),
                ('last_seen', models.DateTimeField(auto_now=True, null=True)),
                ('created', models.DateTimeField(auto_now_add=True, null=True)),
            ],
            options={
                'verbose_name': 'port punch',
                'verbose_name_plural': 'port punches',
            },
        ),
        migrations.CreateModel(
            name='Validated_Client',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('src_ip', models.CharField(help_text='The source IP of client.', max_length=32, verbose_name='Source IP')),
                ('src_port', models.IntegerField(default=0, help_text='The source port of client.', verbose_name='Source Port')),
                ('dst_ip', models.CharField(help_text='The destination IP of server.', max_length=32, verbose_name='Destination IP')),
                ('dst_port', models.IntegerField(default=0, help_text='The destination port of server.', verbose_name='Destination Port')),
                ('last_seen', models.DateTimeField(auto_now=True, null=True)),
                ('created', models.DateTimeField(auto_now_add=True, null=True)),
            ],
            options={
                'verbose_name': 'validated client',
                'verbose_name_plural': 'validated clients',
            },
        ),
        migrations.CreateModel(
            name='Whitelist',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('auto_added', models.BooleanField(default=False, editable=False, help_text='Whether this was added by system', verbose_name='Auto Added')),
                ('prefix', models.CharField(help_text='The prefix in IP/CIDR format', max_length=32, verbose_name='Prefix')),
            ],
            options={
                'verbose_name_plural': 'whitelist IPs',
            },
        ),
        migrations.CreateModel(
            name='Edge_Stats',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('sdate', models.DateTimeField(auto_now=True)),
                ('bla_pckts', models.BigIntegerField(editable=False, null=True)),
                ('bla_pckts_ps', models.BigIntegerField(editable=False, null=True)),
                ('bla_bytes', models.BigIntegerField(editable=False, null=True)),
                ('bla_bytes_ps', models.BigIntegerField(editable=False, null=True)),
                ('whi_pckts', models.BigIntegerField(editable=False, null=True)),
                ('whi_pckts_ps', models.BigIntegerField(editable=False, null=True)),
                ('whi_bytes', models.BigIntegerField(editable=False, null=True)),
                ('whi_bytes_ps', models.BigIntegerField(editable=False, null=True)),
                ('blo_pckts', models.BigIntegerField(editable=False, null=True)),
                ('blo_pckts_ps', models.BigIntegerField(editable=False, null=True)),
                ('blo_bytes', models.BigIntegerField(editable=False, null=True)),
                ('blo_bytes_ps', models.BigIntegerField(editable=False, null=True)),
                ('fwd_pckts', models.BigIntegerField(editable=False, null=True)),
                ('fwd_pckts_ps', models.BigIntegerField(editable=False, null=True)),
                ('fwd_bytes', models.BigIntegerField(editable=False, null=True)),
                ('fwd_bytes_ps', models.BigIntegerField(editable=False, null=True)),
                ('fwdo_pckts', models.BigIntegerField(editable=False, null=True)),
                ('fwdo_pckts_ps', models.BigIntegerField(editable=False, null=True)),
                ('fwdo_bytes', models.BigIntegerField(editable=False, null=True)),
                ('fwdo_bytes_ps', models.BigIntegerField(editable=False, null=True)),
                ('pass_pckts', models.BigIntegerField(editable=False, null=True)),
                ('pass_pckts_ps', models.BigIntegerField(editable=False, null=True)),
                ('pass_bytes', models.BigIntegerField(editable=False, null=True)),
                ('pass_bytes_ps', models.BigIntegerField(editable=False, null=True)),
                ('bad_pckts', models.BigIntegerField(editable=False, null=True)),
                ('bad_pckts_ps', models.BigIntegerField(editable=False, null=True)),
                ('bad_bytes', models.BigIntegerField(editable=False, null=True)),
                ('bad_bytes_ps', models.BigIntegerField(editable=False, null=True)),
                ('a2rp_pckts', models.BigIntegerField(editable=False, null=True)),
                ('a2rp_pckts_ps', models.BigIntegerField(editable=False, null=True)),
                ('a2rp_bytes', models.BigIntegerField(editable=False, null=True)),
                ('a2rp_bytes_ps', models.BigIntegerField(editable=False, null=True)),
                ('a2rs_pckts', models.BigIntegerField(editable=False, null=True)),
                ('a2rs_pckts_ps', models.BigIntegerField(editable=False, null=True)),
                ('a2rs_bytes', models.BigIntegerField(editable=False, null=True)),
                ('a2rs_bytes_ps', models.BigIntegerField(editable=False, null=True)),
                ('dro_pckts', models.BigIntegerField(editable=False, null=True)),
                ('dro_pckts_ps', models.BigIntegerField(editable=False, null=True)),
                ('dro_bytes', models.BigIntegerField(editable=False, null=True)),
                ('dro_bytes_ps', models.BigIntegerField(editable=False, null=True)),
                ('drc_pckts', models.BigIntegerField(editable=False, null=True)),
                ('drc_pckts_ps', models.BigIntegerField(editable=False, null=True)),
                ('drc_bytes', models.BigIntegerField(editable=False, null=True)),
                ('drc_bytes_ps', models.BigIntegerField(editable=False, null=True)),
                ('cpu_load', models.BigIntegerField(editable=False, null=True)),
                ('edge_id', models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, to='connections.edge')),
            ],
        ),
        migrations.CreateModel(
            name='Edge_Settings',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('interface', models.CharField(default='ens18', help_text='The interface for the XDP program to bind to', max_length=64, verbose_name='Interface')),
                ('edge_ip', models.CharField(blank=True, help_text='Override the interface IP (leave blank to have it retrieved automatically, recommended)', max_length=32, verbose_name='Edge IP')),
                ('force_mode', models.IntegerField(choices=[(0, 'None (DRV)'), (1, 'SKB'), (2, 'Offload')], default=0, help_text='The XDP force mode.', verbose_name='XDP Force Mode')),
                ('socket_count', models.IntegerField(default=0, help_text='AF_XDP socket count (0 = use CPU count).', verbose_name='Socket Count')),
                ('queue_is_static', models.BooleanField(default=False, help_text='Whether to use the below queue ID for all socket.', verbose_name='Use Queue ID')),
                ('queue_id', models.IntegerField(default=0, help_text='The queue ID to use if Use Queue ID is enabled.', verbose_name='Queue ID')),
                ('zero_copy', models.BooleanField(default=False, help_text='Whether to enable AF_XDP zero-copy support.', verbose_name='Zero Copy')),
                ('need_wakeup', models.BooleanField(default=True, help_text='AF_XDP enable need wakeup (may cause better performance.', verbose_name='Need Wakeup')),
                ('batch_size', models.IntegerField(default=64, help_text='AF_XDP batch size for RX.', verbose_name='Batch Size')),
                ('verbose', models.BooleanField(default=False, help_text='Whether to enable verbose mode on the edge server.', verbose_name='Verbose')),
                ('calc_stats', models.BooleanField(default=True, help_text='Whether to calculate stats to /etc/kilimanjaro.', verbose_name='Calculate Stats')),
                ('allow_all_edge', models.BooleanField(default=True, help_text='Whether to enable all traffic sent directly to the edge depending on the edge IP.', verbose_name='Allow All Edge Traffic')),
                ('bgp', models.BooleanField(default=True, help_text='Whether to enable BGP.', verbose_name='Enable BGP (AKA Announce)')),
                ('edge_id', models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, to='connections.edge')),
            ],
            options={
                'verbose_name': 'edge setting',
            },
        ),
        migrations.CreateModel(
            name='Connection_Stats',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('pps', models.BigIntegerField(editable=False, null=True)),
                ('bps', models.BigIntegerField(editable=False, null=True)),
                ('connection_id', models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, to='connections.connection')),
            ],
        ),
        migrations.CreateModel(
            name='Connection_A2S_Response',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('response', models.CharField(help_text='A2S_INFO response text.', max_length=2048, verbose_name='A2S_INFO Response')),
                ('expires', models.BigIntegerField(help_text="Response's expire time in nanoseconds.", null=True, verbose_name='Cache Expire Time')),
                ('connection_id', models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, to='connections.connection')),
            ],
            options={
                'verbose_name': 'A2S_INFO response',
                'verbose_name_plural': 'A2S_INFO responses',
            },
        ),
    ]
